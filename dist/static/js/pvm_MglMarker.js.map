{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.object.values.js","webpack:///./node_modules/core-js/internals/object-to-array.js","webpack:///./node_modules/@phila/vue-mapping/src/mapbox/UI/withSelfEvents.js","webpack:///./node_modules/@phila/vue-mapping/src/mapbox/lib/withEvents.js","webpack:///./node_modules/@phila/vue-mapping/src/mapbox/UI/Marker.vue?45b8","webpack:///node_modules/@phila/vue-mapping/src/mapbox/UI/Marker.vue","webpack:///./node_modules/@phila/vue-mapping/src/mapbox/UI/Marker.vue?7ccf","webpack:///./node_modules/@phila/vue-mapping/src/mapbox/UI/Marker.vue"],"names":["$","$values","values","target","stat","O","DESCRIPTORS","objectKeys","toIndexedObject","propertyIsEnumerable","f","createMethod","TO_ENTRIES","it","key","keys","length","i","result","call","push","module","exports","entries","methods","$_emitSelfEvent","event","data","this","$_emitMapEvent","control","$_bindSelfEvents","events","emitter","Object","$listeners","forEach","eventName","includes","on","$_unbindSelfEvents","off","$_emitEvent","name","$emit","map","component","type","mapboxEvent","render","_vm","_h","$createElement","_c","_self","staticStyle","_t","_e","staticRenderFns","drag","dragstart","dragend","click","mouseenter","mouseleave","mixins","inject","provide","self","marker","props","offset","default","coordinates","Array","required","color","String","anchor","draggable","Boolean","initial","undefined","watch","setLngLat","lngLat","setDraggable","next","mounted","$slots","markerOptions","element","elm","mapbox","Marker","newCoordinates","_lngLat","eventNames","$_addMarker","beforeDestroy","remove","addTo","$_bindMarkerDOMEvents","markerDOMEvents","togglePopup"],"mappings":"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","file":"static/js/pvm_MglMarker.js","sourcesContent":["var $ = require('../internals/export');\nvar $values = require('../internals/object-to-array').values;\n\n// `Object.values` method\n// https://tc39.github.io/ecma262/#sec-object.values\n$({ target: 'Object', stat: true }, {\n  values: function values(O) {\n    return $values(O);\n  }\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar objectKeys = require('../internals/object-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar propertyIsEnumerable = require('../internals/object-property-is-enumerable').f;\n\n// `Object.{ entries, values }` methods implementation\nvar createMethod = function (TO_ENTRIES) {\n  return function (it) {\n    var O = toIndexedObject(it);\n    var keys = objectKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || propertyIsEnumerable.call(O, key)) {\n        result.push(TO_ENTRIES ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n\nmodule.exports = {\n  // `Object.entries` method\n  // https://tc39.github.io/ecma262/#sec-object.entries\n  entries: createMethod(true),\n  // `Object.values` method\n  // https://tc39.github.io/ecma262/#sec-object.values\n  values: createMethod(false)\n};\n","export default {\r\n  methods: {\r\n    $_emitSelfEvent(event, data = {}) {\r\n      // console.log('withSelfEvents.js, $emitSelfEvent is running');\r\n      this.$_emitMapEvent(event, { control: this.control, ...data });\r\n    },\r\n    /** Bind events for markers, popups and controls.\r\n     * MapboxGL JS emits this events on popup or marker object,\r\n     * so we treat them as 'self' events of these objects\r\n     */\r\n    $_bindSelfEvents(events, emitter) {\r\n      Object.keys(this.$listeners).forEach(eventName => {\r\n        if (events.includes(eventName)) {\r\n          emitter.on(eventName, this.$_emitSelfEvent);\r\n        }\r\n      });\r\n    },\r\n\r\n    $_unbindSelfEvents(events, emitter) {\r\n      if (events.length === 0) {\r\n        return;\r\n      }\r\n      if (!emitter) {\r\n        return;\r\n      }\r\n      events.forEach(eventName => {\r\n        emitter.off(eventName, this.$_emitSelfEvent);\r\n      });\r\n    },\r\n  },\r\n};\r\n","export default {\r\n  methods: {\r\n    /**\r\n     * Emit Vue event with additional data\r\n     *\r\n     * @param {string} name EventName\r\n     * @param {Object} [data={}] Additional data\r\n     */\r\n    $_emitEvent(name, data = {}) {\r\n      // console.log('$_emitEvent is running, name:', name, 'data:', data, 'this.map:', this.map);\r\n      this.$emit(name, {\r\n        map: this.map,\r\n        component: this,\r\n        ...data,\r\n      });\r\n    },\r\n\r\n    /**\r\n     * Emit Vue event with Mapbox event as additional data\r\n     *\r\n     * @param {Object} event\r\n     */\r\n    $_emitMapEvent(event, data = {}) {\r\n      // console.log('withEvents.js, $_emitMapEvent is running');\r\n      this.$_emitEvent(event.type, { mapboxEvent: event, ...data });\r\n    },\r\n  },\r\n};\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"display\":\"none\"}},[_vm._t(\"marker\"),(_vm.marker)?_vm._t(\"default\"):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div style=\"display: none\">\r\n    <!-- slot for custom marker -->\r\n    <slot name=\"marker\" />\r\n    <!-- slot for popup -->\r\n    <slot v-if=\"marker\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport withEvents from \"../lib/withEvents\";\r\nimport withSelfEvents from \"./withSelfEvents\";\r\n\r\nconst markerEvents = {\r\n  drag: \"drag\",\r\n  dragstart: \"dragstart\",\r\n  dragend: \"dragend\",\r\n};\r\n\r\nconst markerDOMEvents = {\r\n  click: \"click\",\r\n  mouseenter: \"mouseenter\",\r\n  mouseleave: \"mouseleave\",\r\n};\r\n\r\nexport default {\r\n  name: \"MapMarker\",\r\n  mixins: [ withEvents, withSelfEvents ],\r\n\r\n  inject: [ \"mapbox\", \"map\" ],\r\n\r\n  provide() {\r\n    const self = this;\r\n    return {\r\n      get marker() {\r\n        return self.marker;\r\n      },\r\n    };\r\n  },\r\n\r\n  props: {\r\n    // mapbox marker options\r\n    offset: {\r\n      type: [ Object, Array ],\r\n      default: () => [ 0, 0 ],\r\n    },\r\n    coordinates: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    color: {\r\n      type: String,\r\n    },\r\n    anchor: {\r\n      type: String,\r\n      default: \"center\",\r\n    },\r\n    draggable: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      initial: true,\r\n      marker: undefined,\r\n    };\r\n  },\r\n\r\n  watch: {\r\n    coordinates(lngLat) {\r\n      if (this.initial) {\r\n        return;\r\n      }\r\n      this.marker.setLngLat(lngLat);\r\n    },\r\n    draggable(next) {\r\n      if (this.initial) {\r\n        return;\r\n      }\r\n      this.marker.setDraggable(next);\r\n    },\r\n  },\r\n\r\n  mounted() {\r\n    const markerOptions = {\r\n      ...this.$props,\r\n    };\r\n    if (this.$slots.marker) {\r\n      markerOptions.element = this.$slots.marker[0].elm;\r\n    }\r\n    this.marker = new this.mapbox.Marker(markerOptions);\r\n\r\n    if (this.$listeners[\"update:coordinates\"]) {\r\n      this.marker.on(\"dragend\", event => {\r\n        let newCoordinates;\r\n        if (this.coordinates instanceof Array) {\r\n          newCoordinates = [ event.target._lngLat.lng, event.target._lngLat.lat ];\r\n        } else {\r\n          newCoordinates = event.target._lngLat;\r\n        }\r\n        this.$emit(\"update:coordinates\", newCoordinates);\r\n      });\r\n    }\r\n\r\n    const eventNames = Object.keys(markerEvents);\r\n    this.$_bindSelfEvents(eventNames, this.marker);\r\n\r\n    this.initial = false;\r\n    this.$_addMarker();\r\n  },\r\n\r\n  beforeDestroy() {\r\n    if (this.map !== undefined && this.marker !== undefined) {\r\n      this.marker.remove();\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    $_addMarker() {\r\n      this.marker.setLngLat(this.coordinates).addTo(this.map);\r\n      this.$_bindMarkerDOMEvents();\r\n      this.$_emitEvent(\"added\", { marker: this.marker });\r\n    },\r\n\r\n    $_emitSelfEvent(event) {\r\n      this.$_emitMapEvent(event, { marker: this.marker });\r\n    },\r\n\r\n    $_bindMarkerDOMEvents() {\r\n      Object.keys(this.$listeners).forEach(key => {\r\n        if (Object.values(markerDOMEvents).includes(key)) {\r\n          this.marker._element.addEventListener(key, event => {\r\n            this.$_emitSelfEvent(event);\r\n          });\r\n        }\r\n      });\r\n    },\r\n\r\n    remove() {\r\n      this.marker.remove();\r\n      this.$_emitEvent(\"removed\");\r\n    },\r\n\r\n    togglePopup() {\r\n      return this.marker.togglePopup();\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../../../cache-loader/dist/cjs.js??ref--12-0!../../../../../thread-loader/dist/cjs.js!../../../../../babel-loader/lib/index.js!../../../../../cache-loader/dist/cjs.js??ref--0-0!../../../../../vue-loader/lib/index.js??vue-loader-options!./Marker.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../cache-loader/dist/cjs.js??ref--12-0!../../../../../thread-loader/dist/cjs.js!../../../../../babel-loader/lib/index.js!../../../../../cache-loader/dist/cjs.js??ref--0-0!../../../../../vue-loader/lib/index.js??vue-loader-options!./Marker.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Marker.vue?vue&type=template&id=01893212&\"\nimport script from \"./Marker.vue?vue&type=script&lang=js&\"\nexport * from \"./Marker.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}